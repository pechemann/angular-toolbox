<!--
 * LICENSE
 * Copyright Pascal ECHEMANN. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://pascalechemann.com/angular-toolbox/resources/license
-->
 
@if (configApi) {
    <section>
        <h1>{{ title }}</h1>
        <h2>Description</h2>
        @if (configApi.description || configApi.origin) {
            <atx-mock-full-description [config]="configApi"/>
        }
    </section>
    <section>
        <h2>Interceptors</h2>
        <button (click)="toggleExpandState()">{{ expanded ? 'Collapse' : 'Expand' }} all</button>
        @if (configApi.interceptors) {
            @for (inteceptor of configApi.interceptors; track inteceptor) {
                <details>
                    <summary>
                        {{ inteceptor.id }}
                    </summary>
                    @if (inteceptor.description || inteceptor.origin) {
                        <atx-mock-full-description [config]="inteceptor"/>
                    }
                    @for (endpoint of inteceptor.endpoints; track endpoint; let last = $last) {
                        <section class="endpoint">
                            <dl>
                                <dt>route:</dt>
                                <dd><code>{{ endpoint.route }}</code></dd>
                            </dl>
                            @if (endpoint.descriptor) {
                                @if (endpoint.descriptor.description) {
                                    <atx-mock-description [description]="endpoint.descriptor.description"/>
                                }
                                @if (endpoint.descriptor.params) {
                                    <h3>Parameters</h3>
                                    <atx-mock-param [params]="endpoint.descriptor.params"/>
                                }
                            }
                            <h3>Methods</h3>
                            <ul>
                                @for (item of getMethodList(endpoint); track item; let last = $last) {
                                    <li>
                                        <span>{{ item.method }}</span>
                                        @if (item.descriptor) {
                                            <div class="method-descriptor">
                                                @if (item.descriptor.description) {
                                                    <atx-mock-description [description]="item.descriptor.description"/>
                                                }
                                                @if (item.descriptor.payload) {
                                                    <dl>
                                                        <dt>payload:</dt>
                                                        <dd [innerHTML]="item.descriptor.payload"></dd>
                                                    </dl>
                                                }
                                                @if (item.descriptor.body) {
                                                    <dl>
                                                        <dt>body:</dt>
                                                        <dd [innerHTML]="item.descriptor.body"></dd>
                                                    </dl>
                                                }
                                                @if (item.descriptor.queryParams) {
                                                    <h4>Query Parameters</h4>
                                                    <atx-mock-param [params]="item.descriptor.queryParams"/>
                                                }
                                            </div>
                                           
                                        }
                                    </li>
                                    @if (!last) {
                                        <hr>
                                    }
                                }
                            </ul>
                        </section>
                        @if (!last) {
                            <hr>
                        }
                    }
                </details>
            }
        }
    </section>
}
